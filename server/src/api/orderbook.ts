import { AuthCreds } from '../types/Common';
import { IOrderBook } from '../types/ShoonyaData';
import { request } from '../utils/fetchWrapper';

// const data = [
//   {
//     "stat": "Ok",
//     "norenordno": "21120700118892",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "ordenttm": "1638868800",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43169",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17300 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "68.80",
//     "avgprc": "68.65",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "14:50:00 07-12-2021",
//     "exch_tm": "07-12-2021 14:50:00",
//     "exchordid": "1000000115011901",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700116139",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "ordenttm": "1638868807",
//     "trantype": "B",
//     "prctyp": "SL-LMT",
//     "ret": "DAY",
//     "token": "43169",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17300 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "85.00",
//     "trgprc": "81.00",
//     "rprc": "85.00",
//     "rtrgprc": "81.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "CANCELED",
//     "norentm": "14:50:07 07-12-2021",
//     "exch_tm": "07-12-2021 14:50:07",
//     "exchordid": "1000000111940119",
//     "rejreason": "SAF:order is not open to cancel",
//     "cancelqty": "50",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700115979",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "ordenttm": "1638868128",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43169",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17300 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "74.55",
//     "avgprc": "74.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "14:38:48 07-12-2021",
//     "exch_tm": "07-12-2021 14:38:48",
//     "exchordid": "1000000111739025",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700106478",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17250",
//     "qty": "50",
//     "ordenttm": "1638866239",
//     "trantype": "B",
//     "prctyp": "LMT",
//     "ret": "DAY",
//     "token": "43165",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17250 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "110.00",
//     "trgprc": "105.00",
//     "rprc": "110.00",
//     "avgprc": "105.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "14:16:16 07-12-2021",
//     "exch_tm": "07-12-2021 14:07:19",
//     "exchordid": "1000000102502994",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700106390",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17250",
//     "qty": "50",
//     "ordenttm": "1638866217",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43165",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17250 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "96.95",
//     "avgprc": "96.95",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "14:06:57 07-12-2021",
//     "exch_tm": "07-12-2021 14:06:57",
//     "exchordid": "1000000102354933",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700105859",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "ordenttm": "1638866111",
//     "trantype": "B",
//     "prctyp": "SL-LMT",
//     "ret": "DAY",
//     "token": "43169",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17300 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "85.00",
//     "trgprc": "80.00",
//     "rprc": "85.00",
//     "rtrgprc": "80.00",
//     "dscqty": "0",
//     "prd": "M",
//     "status": "CANCELED",
//     "norentm": "14:05:11 07-12-2021",
//     "exch_tm": "07-12-2021 14:05:10",
//     "exchordid": "1000000101721792",
//     "rejreason": "SAF:order is not open to cancel",
//     "cancelqty": "50",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700105739",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "ordenttm": "1638866111",
//     "trantype": "S",
//     "prctyp": "LMT",
//     "ret": "DAY",
//     "token": "43169",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17300 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "74.05",
//     "rprc": "74.05",
//     "dscqty": "0",
//     "prd": "M",
//     "status": "CANCELED",
//     "norentm": "14:05:11 07-12-2021",
//     "exch_tm": "07-12-2021 14:05:11",
//     "exchordid": "1000000101640017",
//     "rejreason": "SAF:order is not open to cancel",
//     "cancelqty": "50",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700104836",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17450",
//     "qty": "50",
//     "ordenttm": "1638865853",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43187",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17450 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "25.65",
//     "avgprc": "25.60",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "14:00:53 07-12-2021",
//     "exch_tm": "07-12-2021 14:00:53",
//     "exchordid": "1000000100558783",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700104584",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16950",
//     "qty": "50",
//     "ordenttm": "1638865789",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43114",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16950 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "0.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "REJECTED",
//     "norentm": "13:59:49 07-12-2021",
//     "rejreason": "RED:Margin Shortfall:INR 507.94 Available:INR 1,23,789.74 for C-FA42057 [SHOONYA]",
//     "rqty": "0"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700104583",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16900",
//     "qty": "50",
//     "ordenttm": "1638865789",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43109",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16900 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "18.00",
//     "avgprc": "18.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "13:59:49 07-12-2021",
//     "exch_tm": "07-12-2021 13:59:49",
//     "exchordid": "1000000100227134",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700097974",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17450",
//     "qty": "50",
//     "ordenttm": "1638864456",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43187",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17450 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "22.25",
//     "avgprc": "22.30",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "13:37:36 07-12-2021",
//     "exch_tm": "07-12-2021 13:37:36",
//     "exchordid": "1000000092664285",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700097972",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "ordenttm": "1638864456",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43185",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17400 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "32.95",
//     "avgprc": "33.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "13:37:36 07-12-2021",
//     "exch_tm": "07-12-2021 13:37:36",
//     "exchordid": "1000000092663431",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700073931",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16900",
//     "qty": "50",
//     "ordenttm": "1638859882",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43109",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16900 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "21.65",
//     "avgprc": "21.65",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "12:21:22 07-12-2021",
//     "exch_tm": "07-12-2021 12:21:22",
//     "exchordid": "1000000066810087",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700073930",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16850",
//     "qty": "50",
//     "ordenttm": "1638859882",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43078",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16850 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "16.90",
//     "avgprc": "16.85",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "12:21:22 07-12-2021",
//     "exch_tm": "07-12-2021 12:21:22",
//     "exchordid": "1000000066810039",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700050511",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16850",
//     "qty": "50",
//     "ordenttm": "1638855849",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43078",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16850 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "21.95",
//     "avgprc": "22.00",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:14:09 07-12-2021",
//     "exch_tm": "07-12-2021 11:14:09",
//     "exchordid": "1000000049421014",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700050509",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "ordenttm": "1638855849",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43066",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16800 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "17.30",
//     "avgprc": "17.35",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:14:09 07-12-2021",
//     "exch_tm": "07-12-2021 11:14:09",
//     "exchordid": "1000000049420562",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700046102",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "ordenttm": "1638855128",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43066",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16800 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "21.05",
//     "avgprc": "21.10",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:02:08 07-12-2021",
//     "exch_tm": "07-12-2021 11:02:08",
//     "exchordid": "1000000045995678",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700046101",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "ordenttm": "1638855128",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43185",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17400 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "23.55",
//     "avgprc": "23.55",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:02:08 07-12-2021",
//     "exch_tm": "07-12-2021 11:02:08",
//     "exchordid": "1000000045995369",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045696",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "ordenttm": "1638855048",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43185",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17400 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "25.90",
//     "avgprc": "25.90",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:00:48 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:48",
//     "exchordid": "1000000045586822",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045695",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "ordenttm": "1638855048",
//     "trantype": "B",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43066",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16800 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "19.95",
//     "avgprc": "19.95",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:00:48 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:48",
//     "exchordid": "1000000045586651",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045522",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "ordenttm": "1638855011",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43066",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 16800 PE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "19.55",
//     "avgprc": "19.55",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:00:11 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:11",
//     "exchordid": "1000000045441029",
//     "rqty": "50"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045521",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "ordenttm": "1638855011",
//     "trantype": "S",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "token": "43185",
//     "mult": "1",
//     "prcftr": "1.000000",
//     "dname": "NIFTY 09DEC21 17400 CE ",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "rprc": "26.35",
//     "avgprc": "26.30",
//     "dscqty": "0",
//     "prd": "I",
//     "status": "COMPLETE",
//     "fillshares": "50",
//     "norentm": "11:00:11 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:11",
//     "exchordid": "1000000045440712",
//     "rqty": "50"
//   }
// ]

export const getShoonyaOrderBook = async ({ uid, jKey }: AuthCreds): Promise<{ data: IOrderBook[]; status: number }> => {
	try {
		const { data, status } = await request<IOrderBook[]>('https://shoonya.finvasia.com/NorenWClientWeb/OrderBook', {
			method: 'POST',
			headers: {
				'content-type': 'text/plain; charset=utf-8',
			},
			body: `jData={"uid":"${uid}","actid":"${uid}"}&jKey=${jKey}`,
		});

		return { data, status };
	} catch (err) {
		console.log('Something went wrong!\n', err);
		throw new Error(err as string);
	}
};
