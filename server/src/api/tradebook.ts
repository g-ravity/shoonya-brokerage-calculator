import { AuthCreds } from '../types/Common';
import { ITradeBook } from '../types/ShoonyaData';
import { request } from '../utils/fetchWrapper';

// const data = [
//   {
//     "stat": "Ok",
//     "norenordno": "21120700118892",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "9334054",
//     "fltm": "07-12-2021 14:50:00",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "token": "43169",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "68.65",
//     "norentm": "14:50:00 07-12-2021",
//     "exch_tm": "07-12-2021 14:50:00",
//     "exchordid": "1000000115011901"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700115979",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "9097361",
//     "fltm": "07-12-2021 14:38:48",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21C17300",
//     "qty": "50",
//     "token": "43169",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "74.00",
//     "norentm": "14:38:48 07-12-2021",
//     "exch_tm": "07-12-2021 14:38:48",
//     "exchordid": "1000000111739025"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700106478",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "LMT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "8576382",
//     "fltm": "07-12-2021 14:16:16",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21C17250",
//     "qty": "50",
//     "token": "43165",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "110.00",
//     "flprc": "105.00",
//     "norentm": "14:16:16 07-12-2021",
//     "exch_tm": "07-12-2021 14:07:19",
//     "exchordid": "1000000102502994"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700106390",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "8360009",
//     "fltm": "07-12-2021 14:06:57",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21C17250",
//     "qty": "50",
//     "token": "43165",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "96.95",
//     "norentm": "14:06:57 07-12-2021",
//     "exch_tm": "07-12-2021 14:06:57",
//     "exchordid": "1000000102354933"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700104836",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "8216389",
//     "fltm": "07-12-2021 14:00:53",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21C17450",
//     "qty": "50",
//     "token": "43187",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "25.60",
//     "norentm": "14:00:53 07-12-2021",
//     "exch_tm": "07-12-2021 14:00:53",
//     "exchordid": "1000000100558783"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700104583",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "8187736",
//     "fltm": "07-12-2021 13:59:49",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21P16900",
//     "qty": "50",
//     "token": "43109",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "18.00",
//     "norentm": "13:59:49 07-12-2021",
//     "exch_tm": "07-12-2021 13:59:49",
//     "exchordid": "1000000100227134"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700097974",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "7534436",
//     "fltm": "07-12-2021 13:37:36",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21C17450",
//     "qty": "50",
//     "token": "43187",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "22.30",
//     "norentm": "13:37:36 07-12-2021",
//     "exch_tm": "07-12-2021 13:37:36",
//     "exchordid": "1000000092664285"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700097972",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "7534362",
//     "fltm": "07-12-2021 13:37:36",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "token": "43185",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "33.00",
//     "norentm": "13:37:36 07-12-2021",
//     "exch_tm": "07-12-2021 13:37:36",
//     "exchordid": "1000000092663431"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700073931",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "5757813",
//     "fltm": "07-12-2021 12:21:22",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21P16900",
//     "qty": "50",
//     "token": "43109",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "21.65",
//     "norentm": "12:21:22 07-12-2021",
//     "exch_tm": "07-12-2021 12:21:22",
//     "exchordid": "1000000066810087"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700073930",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "5757808",
//     "fltm": "07-12-2021 12:21:22",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21P16850",
//     "qty": "50",
//     "token": "43078",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "16.85",
//     "norentm": "12:21:22 07-12-2021",
//     "exch_tm": "07-12-2021 12:21:22",
//     "exchordid": "1000000066810039"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700050511",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4462728",
//     "fltm": "07-12-2021 11:14:09",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21P16850",
//     "qty": "50",
//     "token": "43078",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "22.00",
//     "norentm": "11:14:09 07-12-2021",
//     "exch_tm": "07-12-2021 11:14:09",
//     "exchordid": "1000000049421014"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700050509",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4462684",
//     "fltm": "07-12-2021 11:14:09",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "token": "43066",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "17.35",
//     "norentm": "11:14:09 07-12-2021",
//     "exch_tm": "07-12-2021 11:14:09",
//     "exchordid": "1000000049420562"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700046102",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4151124",
//     "fltm": "07-12-2021 11:02:08",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "token": "43066",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "21.10",
//     "norentm": "11:02:08 07-12-2021",
//     "exch_tm": "07-12-2021 11:02:08",
//     "exchordid": "1000000045995678"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700046101",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4151078",
//     "fltm": "07-12-2021 11:02:08",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "token": "43185",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "23.55",
//     "norentm": "11:02:08 07-12-2021",
//     "exch_tm": "07-12-2021 11:02:08",
//     "exchordid": "1000000045995369"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045696",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4109446",
//     "fltm": "07-12-2021 11:00:48",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "token": "43185",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "25.90",
//     "norentm": "11:00:48 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:48",
//     "exchordid": "1000000045586822"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045695",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4109425",
//     "fltm": "07-12-2021 11:00:48",
//     "trantype": "B",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "token": "43066",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "19.95",
//     "norentm": "11:00:48 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:48",
//     "exchordid": "1000000045586651"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045522",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4095742",
//     "fltm": "07-12-2021 11:00:11",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21P16800",
//     "qty": "50",
//     "token": "43066",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "19.55",
//     "norentm": "11:00:11 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:11",
//     "exchordid": "1000000045441029"
//   },
//   {
//     "stat": "Ok",
//     "norenordno": "21120700045521",
//     "uid": "FA42057",
//     "actid": "FA42057",
//     "exch": "NFO",
//     "prctyp": "MKT",
//     "ret": "DAY",
//     "prd": "I",
//     "flid": "4095715",
//     "fltm": "07-12-2021 11:00:11",
//     "trantype": "S",
//     "tsym": "NIFTY09DEC21C17400",
//     "qty": "50",
//     "token": "43185",
//     "fillshares": "50",
//     "flqty": "50",
//     "pp": "2",
//     "ls": "50",
//     "ti": "0.05",
//     "prc": "0.00",
//     "flprc": "26.30",
//     "norentm": "11:00:11 07-12-2021",
//     "exch_tm": "07-12-2021 11:00:11",
//     "exchordid": "1000000045440712"
//   }
// ]

export const getShoonyaTradeBook = async ({ uid, jKey }: AuthCreds): Promise<{ data: ITradeBook[]; status: number }> => {
	try {
		const { data, status } = await request<ITradeBook[]>('https://shoonya.finvasia.com/NorenWClientWeb/TradeBook', {
			method: 'POST',
			headers: {
				'content-type': 'text/plain; charset=utf-8',
			},
			body: `jData={"uid":"${uid}","actid":"${uid}"}&jKey=${jKey}`,
		});

		return { data, status };
	} catch (err) {
		console.log('Something went wrong!\n', err);
		throw new Error(err as string);
	}
};
